param virtualMachineName string
param location string
param RealtimeProtectionEnabled bool
param ScheduledScanSettingsIsEnabled bool
param ScheduledScanSettingsDay string
param ScheduledScanSettingsTime string
param ScheduledScanSettingsScanType string
param AVExclusionsExtensions string
param AVExclusionsPaths string
param AVExclusionsProcesses string

resource virtualMachine 'Microsoft.Compute/virtualMachines@2022-03-01' = {
  name: virtualMachineName
  location: location
}

resource sqlSrvDBName_IaaSAntimalware 'Microsoft.Compute/virtualMachines/extensions@2018-06-01' = {
  name: '${virtualMachineName}/IaaSAntimalware'
  location: location
  dependsOn: [
    virtualMachine
  ]
  properties: {
    publisher: 'Microsoft.Azure.Security'
    type: 'IaaSAntimalware'
    typeHandlerVersion: '1.3'
    autoUpgradeMinorVersion: true
    settings: {
      AntimalwareEnabled: true
      RealtimeProtectionEnabled: RealtimeProtectionEnabled
      ScheduledScanSettings: {
        isEnabled: ScheduledScanSettingsIsEnabled
        day: ScheduledScanSettingsDay
        time: ScheduledScanSettingsTime
        scanType: ScheduledScanSettingsScanType
      }
      Exclusions: {
        Extensions: AVExclusionsExtensions
        Paths: AVExclusionsPaths
        Processes: AVExclusionsProcesses
      }
    }
  }
}

 

